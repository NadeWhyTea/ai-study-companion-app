<!DOCTYPE html>
<html>
<head>
  <base href="$FLUTTER_BASE_HREF">
  <meta charset="UTF-8">
  <meta name="google-signin-client_id"
        content="361742280563-5pjjvmevk9vn0pl5rfg6s6qauointgdn.apps.googleusercontent.com">
  <meta name="description" content="AI Study Companion App">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="AI Study Companion App">
  <link rel="apple-touch-icon" href="icons/Icon-192.png">
  <link rel="icon" type="image/png" href="favicon.png"/>
  <title>AI Study Companion App</title>
  <link rel="manifest" href="manifest.json">
</head>
<body>
<!-- Flutter -->
<script src="flutter_bootstrap.js" async></script>

<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-auth-compat.js"></script>

<!-- Google Identity Services -->
<script src="https://accounts.google.com/gsi/client" async defer></script>

<!-- Google Sign-In Button container -->
<div id="g_id_signin" style="display:flex;justify-content:center;margin-top:40px;"></div>

<!-- Firebase config -->
<script>
  const firebaseConfig = {
    apiKey: "AIzaSyCHCJB5wyZ8d9l-VuvDs7ViSb1_lvL640M",
    authDomain: "aistudycompanion-350c6.firebaseapp.com",
    projectId: "aistudycompanion-350c6",
    storageBucket: "aistudycompanion-350c6.firebasestorage.app",
    messagingSenderId: "497319698545",
    appId: "1:497319698545:web:76635d5749c15c66e33bd0",
    measurementId: "G-MF35C5NKF8"
  };
  firebase.initializeApp(firebaseConfig);
</script>

<!-- Google Sign-In initialization -->
<script>
  function handleCredentialResponse(response) {
    console.log("Google credential received:", response);
    if (window.flutterWebSdkCallback) {
      window.flutterWebSdkCallback(response.credential);
    } else {
      console.error("Flutter callback not found!");
    }
  }

  function initGoogleSignIn() {
    google.accounts.id.setUseFedCMForPrompt(false);

    google.accounts.id.initialize({
      client_id: '361742280563-5pjjvmevk9vn0pl5rfg6s6qauointgdn.apps.googleusercontent.com',
      callback: handleCredentialResponse,
      auto_select: false,
      cancel_on_tap_outside: true,
      ux_mode: 'popup'
    });

    // Render the Google sign-in button
    google.accounts.id.renderButton(
            document.getElementById('g_id_signin'),
            { theme: 'outline', size: 'large', width: 240 }
    );

    // Optionally prompt users (you can remove this if undesired)
    google.accounts.id.prompt();
  }

  // Wait until the page loads to initialize
  if (document.readyState === 'complete') {
    initGoogleSignIn();
  } else {
    window.addEventListener('load', initGoogleSignIn);
  }
</script>
</body>
</html>